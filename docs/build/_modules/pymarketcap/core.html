

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pymarketcap.core &mdash; pymarketcap 3.3.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="pymarketcap 3.3.0 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> pymarketcap
          

          
          </a>

          
            
            
              <div class="version">
                3.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pymarketcap.html">pymarketcap package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pymarketcap</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pymarketcap.core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pymarketcap.core</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;Pymarketcap core, web parser and API wrapper&quot;&quot;&quot;</span>

<span class="c1"># Python standard library</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">re</span> <span class="k">import</span> <span class="n">sub</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="k">import</span> <span class="n">Decimal</span>

<span class="c1"># Third party libraries</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">get</span>
<span class="kn">from</span> <span class="nn">requests.compat</span> <span class="k">import</span> <span class="n">urljoin</span><span class="p">,</span> <span class="n">urlencode</span>
<span class="kn">from</span> <span class="nn">requests.exceptions</span> <span class="k">import</span> <span class="n">HTTPError</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="k">import</span> <span class="n">BeautifulSoup</span>


<div class="viewcode-block" id="CoinmarketcapError"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.CoinmarketcapError">[docs]</a><span class="k">class</span> <span class="nc">CoinmarketcapError</span><span class="p">(</span><span class="n">HTTPError</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exception for catch invalid commands and other repsonses</span>
<span class="sd">    that don&#39;t match with 200 code responses.</span>

<span class="sd">    Args:</span>
<span class="sd">       code (str): Exception error code.</span>
<span class="sd">       msg (str): Human readable string describing the exception.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">CoinmarketcapError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="Pymarketcap"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap">[docs]</a><span class="k">class</span> <span class="nc">Pymarketcap</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse_float</span><span class="o">=</span><span class="n">Decimal</span><span class="p">,</span>
                 <span class="n">parse_int</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">pair_separator</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Main class for retrieve data from coinmarketcap.com</span>

<span class="sd">        Args:</span>
<span class="sd">            parse_float (any, optional): Parser used by json.loads()</span>
<span class="sd">                for retrieve float type data. As default, decimal.Decimal</span>
<span class="sd">            parse_int (any, optional): Parser used by json.loads()</span>
<span class="sd">                for retrieve int type data. As default, int</span>
<span class="sd">            pair_separator (str, optional): Separator between base and</span>
<span class="sd">                quote pair in responses. As default &quot;-&quot;</span>
<span class="sd">                (ie: ``pair_separator=&quot;_&quot;`` -&gt; ``&quot;BTC_USD&quot;``)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base_url</span><span class="p">,</span> <span class="n">api_version</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span> <span class="s2">&quot;v1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">api.coinmarketcap.com/</span><span class="si">%s</span><span class="s2">/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">api_version</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web_url</span> <span class="o">=</span> <span class="s1">&#39;https://coinmarketcap.com/&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span> <span class="o">=</span> <span class="n">parse_float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span> <span class="o">=</span> <span class="n">parse_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pair_separator</span> <span class="o">=</span> <span class="n">pair_separator</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_correspondences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_symbols</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_correspondences</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_cache_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Internal function for load in cache al symbols</span>
<span class="sd">        in coinmarketcap with their respectives currency names&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="s2">&quot;ticker/&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">currency</span> <span class="ow">in</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">():</span>
            <span class="n">response</span><span class="p">[</span><span class="n">currency</span><span class="p">[</span><span class="s2">&quot;symbol&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">currency</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">response</span>


    <span class="c1">#######   API METHODS   #######</span>

<div class="viewcode-block" id="Pymarketcap.ticker"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.ticker">[docs]</a>    <span class="k">def</span> <span class="nf">ticker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get currencies with other aditional data.</span>

<span class="sd">        Args:</span>
<span class="sd">            currency (str, optional): Specify a currency to return,</span>
<span class="sd">                in this case the method returns a dict, otherwise</span>
<span class="sd">                returns a list. As default, None.</span>
<span class="sd">            convert (str, optional): As default, None. Allow to</span>
<span class="sd">                convert prices in response on one of next badges:</span>
<span class="sd">                [&quot;AUD&quot;, &quot;BRL&quot;, &quot;CAD&quot;, &quot;CHF&quot;, &quot;CLP&quot;, &quot;CNY&quot;, &quot;CZK&quot;, &quot;DKK&quot;,</span>
<span class="sd">                &quot;EUR&quot;, &quot;GBP&quot;, &quot;HKD&quot;, &quot;HUF&quot;, &quot;IDR&quot;, &quot;ILS&quot;, &quot;INR&quot;, &quot;JPY&quot;,</span>
<span class="sd">                &quot;KRW&quot;, &quot;MXN&quot;, &quot;MYR&quot;, &quot;NOK&quot;, &quot;NZD&quot;, &quot;PHP&quot;, &quot;PKR&quot;, &quot;PLN&quot;,</span>
<span class="sd">                &quot;RUB&quot;, &quot;SEK&quot;, &quot;SGD&quot;, &quot;THB&quot;, &quot;TRY&quot;, &quot;TWD&quot;, &quot;ZAR&quot;, &quot;USD&quot;]</span>
<span class="sd">            limit (int, optional): Limit amount of coins on response.</span>
<span class="sd">                Only works if ``currency == None``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: If currency param is not provided.</span>
<span class="sd">            dict: If you specifies currency param.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">convert</span><span class="p">:</span>
            <span class="n">convert</span> <span class="o">=</span> <span class="s2">&quot;USD&quot;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="s2">&quot;ticker/&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">currency</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">currency</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="n">currency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correspondences</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span>
            <span class="n">url</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/&quot;</span> <span class="o">%</span> <span class="n">currency</span>

        <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">convert</span><span class="o">=</span><span class="n">convert</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span>

        <span class="n">url</span> <span class="o">+=</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">parse_currency</span><span class="p">(</span><span class="n">raw_data</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Internal function to parse every currency</span>
<span class="sd">            in the provided types in constructor</span>

<span class="sd">            Args:</span>
<span class="sd">                raw_data: Response provided by the API on ticker method</span>

<span class="sd">            Returns:</span>
<span class="sd">                dict: Parsed values</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">value_types</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;price_btc&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;price_usd&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;percent_change_7d&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;percent_change_1h&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                <span class="s1">&#39;percent_change_24h&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;market_cap_usd&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;market_cap_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">convert</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;last_updated&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">,</span>
                <span class="s1">&#39;rank&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">,</span>
                <span class="s1">&#39;available_supply&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;price_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">convert</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                <span class="s1">&#39;24h_volume_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">convert</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;24h_volume_usd&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;total_supply&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;max_supply&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">,</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">str</span>
            <span class="p">}</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_types</span><span class="p">[</span><span class="n">key</span><span class="p">](</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">data</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">currency</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">parse_currency</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">curr</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parse_currency</span><span class="p">(</span><span class="n">curr</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">response</span></div>


<div class="viewcode-block" id="Pymarketcap.stats"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.stats">[docs]</a>    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get global cryptocurrencies statistics.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Global markets statistics</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="s1">&#39;global/&#39;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">parse_int</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">,</span>
                                 <span class="n">parse_float</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>


    <span class="c1">#######    WEB PARSER METHODS    #######</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_html</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Internal function for get plain html pages</span>

<span class="sd">        Args:</span>
<span class="sd">            url: Url page to obtain plain html code</span>

<span class="sd">        Raises:</span>
<span class="sd">            CoinmarketcapError: if status code is not equal to 200</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Plain html parsed with BeautifulSoup html parser</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">status_code</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">if</span> <span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CoinmarketcapError</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>

<div class="viewcode-block" id="Pymarketcap.markets"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.markets">[docs]</a>    <span class="k">def</span> <span class="nf">markets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Function that returns information from markets</span>
<span class="sd">        availables at coinmarketcap. It needs a currency as argument.</span>

<span class="sd">        Args:</span>
<span class="sd">            currency (str): Currency to get market data</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: markets on wich provided currency is currently tradeable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">currency</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
            <span class="n">currency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correspondences</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span>

        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">web_url</span><span class="p">,</span> <span class="s2">&quot;currencies/</span><span class="si">%s</span><span class="s2">/&quot;</span> <span class="o">%</span> <span class="n">currency</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">marks</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;tbody&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">:</span>
            <span class="n">_volume_24h</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;volume&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span>
            <span class="n">volume_24h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\D&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">_volume_24h</span><span class="p">))</span>
            <span class="n">_price</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;price&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span>
            <span class="n">price</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$| |\*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">_price</span><span class="p">))</span>

            <span class="n">_childs</span><span class="p">,</span> <span class="n">childs</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_childs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">childs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">childs</span><span class="p">):</span>
                <span class="n">nav</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">string</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">exchange</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nav</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">pair</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pair_separator</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">pair</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
                        <span class="n">pair</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; *&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">percent_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">nav</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="n">market</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;exchange&#39;</span><span class="p">:</span> <span class="n">exchange</span><span class="p">,</span> <span class="s1">&#39;pair&#39;</span><span class="p">:</span> <span class="n">pair</span><span class="p">,</span>
                      <span class="s1">&#39;24h_volume_usd&#39;</span><span class="p">:</span> <span class="n">volume_24h</span><span class="p">,</span>
                      <span class="s1">&#39;price_usd&#39;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span>
                      <span class="s1">&#39;percent_volume&#39;</span><span class="p">:</span> <span class="n">percent_volume</span><span class="p">}</span>
            <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">market</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span></div>

    <span class="k">def</span> <span class="nf">_get_ranks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Internal function for get gainers and losers</span>

<span class="sd">        Args:</span>
<span class="sd">            query: Query to obtain ranks, gainers or losers</span>
<span class="sd">            temp: Temporal period obtaining gainers or losers,</span>
<span class="sd">                1h, 24h or 7d</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">web_url</span><span class="p">,</span> <span class="s1">&#39;gainers-losers/&#39;</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">call</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">html_rank</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">call</span><span class="p">})</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">curr</span> <span class="ow">in</span> <span class="n">html_rank</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">_childs</span><span class="p">,</span> <span class="n">childs</span> <span class="o">=</span> <span class="p">(</span><span class="n">curr</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_childs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">childs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">childs</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">symbol</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">_volume_24h</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$|,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">volume_24h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">_volume_24h</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">_price</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">price</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">_price</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">percent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">string</span><span class="p">))</span>
            <span class="n">currency</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                        <span class="s1">&#39;24h_volume_usd&#39;</span><span class="p">:</span> <span class="n">volume_24h</span><span class="p">,</span>
                        <span class="s1">&#39;price_usd&#39;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s1">&#39;percent_change&#39;</span><span class="p">:</span> <span class="n">percent</span><span class="p">}</span>
            <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currency</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>

<div class="viewcode-block" id="Pymarketcap.ranks"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.ranks">[docs]</a>    <span class="k">def</span> <span class="nf">ranks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns data from gainers and losers rankings:</span>

<span class="sd">        Args:</span>
<span class="sd">            *args (str, optional): Positional arguments</span>
<span class="sd">                for filter rankings. Valid arguments:</span>
<span class="sd">                     [&#39;7d&#39;, &#39;24h&#39;, &#39;1h&#39;, &#39;gainers&#39;, &#39;losers&#39;]</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Gainers, losers or both rankings,</span>
<span class="sd">                depends of arguments filter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_temps</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1h&#39;</span><span class="p">,</span> <span class="s1">&#39;24h&#39;</span><span class="p">,</span> <span class="s1">&#39;7d&#39;</span><span class="p">]</span>
        <span class="n">all_queries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gainers&#39;</span><span class="p">,</span> <span class="s1">&#39;losers&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>   <span class="c1"># if len(args) == 0</span>
            <span class="n">temps</span><span class="p">,</span> <span class="n">queries</span> <span class="o">=</span> <span class="p">(</span><span class="n">all_temps</span><span class="p">,</span> <span class="n">all_queries</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">temps</span><span class="p">,</span> <span class="n">queries</span> <span class="o">=</span> <span class="p">([],</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">all_temps</span><span class="p">:</span> <span class="n">temps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">all_queries</span><span class="p">:</span> <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a valid argument&#39;</span> <span class="o">%</span> <span class="n">a</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">temps</span><span class="p">:</span>
                <span class="n">temps</span> <span class="o">=</span> <span class="n">all_temps</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">queries</span><span class="p">:</span>
                <span class="n">queries</span> <span class="o">=</span> <span class="n">all_queries</span>

        <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
            <span class="n">rankings</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
                <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ranks</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
                <span class="n">rankings</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranking</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">response</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">rankings</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">response</span> <span class="o">=</span> <span class="n">rankings</span>

        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Pymarketcap.historical"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.historical">[docs]</a>    <span class="k">def</span> <span class="nf">historical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">revert</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get historical data for a currency.</span>

<span class="sd">        Args:</span>
<span class="sd">            currency (str): Currency to scrap historical data</span>
<span class="sd">            start (date, optional): Time to start scraping</span>
<span class="sd">                periods as datetime.datetime type.</span>
<span class="sd">                As default datetime(2018, 8, 18)</span>
<span class="sd">            end (date, optional): Time to end scraping periods</span>
<span class="sd">                as datetime.datetime type.</span>
<span class="sd">                As default datetime.now()</span>
<span class="sd">            revert (bool, optional): If False, return first date</span>
<span class="sd">                first, in chronological order, otherwise returns</span>
<span class="sd">                reversed list of periods. As default False</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: Historical dayly results for low, high, open, close</span>
<span class="sd">                usd_market_cap and usd_volume</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">start</span><span class="p">:</span> <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">end</span><span class="p">:</span> <span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">currency</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
            <span class="n">currency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correspondences</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">web_url</span> <span class="o">+</span> <span class="s1">&#39;currencies/&#39;</span> <span class="o">+</span> <span class="n">currency</span> <span class="o">+</span> <span class="s1">&#39;/historical-data/&#39;</span>
        <span class="n">url</span> <span class="o">+=</span> <span class="s1">&#39;?start=</span><span class="si">{}</span><span class="s1">&amp;end=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">day</span><span class="p">),</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">end</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">end</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">end</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">marks</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;tbody&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
        <span class="c1">#print(marks[0])</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">:</span>
            <span class="n">insert</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># Ignore all dates not in range</span>
            <span class="n">_childs</span><span class="p">,</span> <span class="n">childs</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_childs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">childs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">indicators</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">childs</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">_date</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">_date</span><span class="p">,</span> <span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1"> %Y&#39;</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">date</span> <span class="o">=</span> <span class="n">_date</span> <span class="c1">#datetime.strptime(&#39;Jan 01 0001&#39;, &#39;%b %d %Y&#39;)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">date</span> <span class="o">&lt;</span> <span class="n">start</span> <span class="ow">or</span> <span class="n">date</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
                            <span class="n">insert</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">break</span>
                    <span class="n">indicators</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">_open</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">indicators</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_open</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">_high</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">indicators</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_high</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">_low</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">indicators</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_low</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">_close</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">indicators</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_close</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">_usd_volume</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_usd_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">_usd_volume</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="n">indicators</span><span class="p">[</span><span class="s1">&#39;usd_volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_usd_volume</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                    <span class="n">_usd_market_cap</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_usd_market_cap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">_usd_market_cap</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="n">indicators</span><span class="p">[</span><span class="s1">&#39;usd_market_cap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_usd_market_cap</span>
            <span class="k">if</span> <span class="n">insert</span><span class="p">:</span>
                <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicators</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">revert</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Pymarketcap.recently"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.recently">[docs]</a>    <span class="k">def</span> <span class="nf">recently</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get recently added currencies along</span>
<span class="sd">        with other metadata</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: Recently added currencies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">web_url</span><span class="p">,</span> <span class="s1">&#39;new/&#39;</span><span class="p">)</span>

        <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">marks</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;tbody&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">:</span>
            <span class="n">_childs</span><span class="p">,</span> <span class="n">childs</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_childs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">childs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">childs</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">symbol</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">days_ago</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\D&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">days_ago</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">days_ago</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">_usd_market_cap</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">usd_market_cap</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_usd_market_cap</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                    <span class="k">if</span> <span class="s1">&#39;$&#39;</span> <span class="ow">in</span> <span class="n">usd_market_cap</span><span class="p">:</span>
                        <span class="n">usd_market_cap</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$|,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">usd_market_cap</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">_price_usd</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">price_usd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39; |\$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">_price_usd</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">circulating_supply</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">circulating_supply</span><span class="p">:</span>
                        <span class="n">circulating_supply</span> <span class="o">=</span> <span class="n">circulating_supply</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                        <span class="n">mineable</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">mineable</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">circulating_supply</span><span class="p">:</span>
                        <span class="n">_circulating_supply</span> <span class="o">=</span> <span class="n">circulating_supply</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                        <span class="n">circulating_supply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">_circulating_supply</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                    <span class="n">_volume_24h_usd</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">volume_24h_usd</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$|,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">_volume_24h_usd</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">volume_24h_usd</span> <span class="o">!=</span> <span class="s1">&#39;Low Vol&#39;</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">volume_24h_usd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">volume_24h_usd</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="c1"># Is a &#39;?&#39; value?</span>
                            <span class="k">if</span> <span class="n">volume_24h_usd</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
                                <span class="k">pass</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;volume_24h_usd ==&#39;</span><span class="p">,</span> <span class="n">volume_24h_usd</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                    <span class="n">percent_change</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; %&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">percent_change</span><span class="p">:</span>
                        <span class="n">percent_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">percent_change</span><span class="p">)</span>
            <span class="n">indicators</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                          <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span>
                          <span class="s1">&#39;days_ago&#39;</span><span class="p">:</span> <span class="n">days_ago</span><span class="p">,</span>
                          <span class="s1">&#39;usd_market_cap&#39;</span><span class="p">:</span> <span class="n">usd_market_cap</span><span class="p">,</span>
                          <span class="s1">&#39;price_usd&#39;</span><span class="p">:</span> <span class="n">price_usd</span><span class="p">,</span>
                          <span class="s1">&#39;circulating_supply&#39;</span><span class="p">:</span> <span class="n">circulating_supply</span><span class="p">,</span>
                          <span class="s1">&#39;mineable&#39;</span><span class="p">:</span> <span class="n">mineable</span><span class="p">,</span>
                          <span class="s1">&#39;volume_24h_usd&#39;</span><span class="p">:</span> <span class="n">volume_24h_usd</span><span class="p">}</span>
            <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicators</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exchange_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Internal function for get all exchange</span>
<span class="sd">        names available currently in coinmarketcap.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exchanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchanges</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">exchange</span> <span class="ow">in</span> <span class="n">exchanges</span><span class="p">:</span>
            <span class="n">exch</span> <span class="o">=</span> <span class="n">exchange</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">exch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
                <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exch</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>

<div class="viewcode-block" id="Pymarketcap.exchange"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.exchange">[docs]</a>    <span class="k">def</span> <span class="nf">exchange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Obtain data from a exchange passed as argument</span>

<span class="sd">        Example:</span>
<span class="sd">            exchange(&#39;poloniex&#39;)</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Exchange to retrieve data</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: Data from all markets in a exchange</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">web_url</span><span class="p">,</span> <span class="s1">&#39;exchanges/</span><span class="si">%s</span><span class="s1">/&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">marks</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">_childs</span><span class="p">,</span> <span class="n">childs</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_childs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                    <span class="n">childs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">childs</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rank</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">market</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                        <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pair_separator</span>
                    <span class="p">))</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">_volume_24h_usd</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$|,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">volume_24h_usd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">_volume_24h_usd</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">_price_usd</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$| |\*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                    <span class="n">price_usd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">_price_usd</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">_perc_volume</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">perc_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span><span class="n">_perc_volume</span><span class="p">)</span>
            <span class="n">indicators</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rank&#39;</span><span class="p">:</span> <span class="n">rank</span><span class="p">,</span>
                          <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                          <span class="s1">&#39;market&#39;</span><span class="p">:</span> <span class="n">market</span><span class="p">,</span>
                          <span class="s1">&#39;volume_24h_usd&#39;</span><span class="p">:</span> <span class="n">volume_24h_usd</span><span class="p">,</span>
                          <span class="s1">&#39;price_usd&#39;</span><span class="p">:</span> <span class="n">price_usd</span><span class="p">,</span>
                          <span class="s1">&#39;perc_volume&#39;</span><span class="p">:</span> <span class="n">perc_volume</span><span class="p">}</span>
            <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicators</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="Pymarketcap.exchanges"><a class="viewcode-back" href="../../pymarketcap.html#pymarketcap.core.Pymarketcap.exchanges">[docs]</a>    <span class="k">def</span> <span class="nf">exchanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all the exchanges markets data</span>
<span class="sd">        in coninmarketcap ranked by volumes.</span>

<span class="sd">        Args:</span>
<span class="sd">            limit (int, optional): Limit the amount</span>
<span class="sd">                of exchanges in response. As default, 50</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: Markets by exchanges and volumes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">urljoin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">web_url</span><span class="p">,</span> <span class="s1">&#39;exchanges/volume/24-hour/all/&#39;</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="n">exs</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span> <span class="c1"># Exchanges</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">exs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exchange</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;Pair&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s1">&#39;Total&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                        <span class="n">_total</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\$|,|Total&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                        <span class="n">total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">_total</span><span class="p">)</span>
                        <span class="n">exchange_data</span><span class="p">[</span><span class="s1">&#39;volume_usd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total</span>
                    <span class="k">if</span> <span class="s1">&#39;View More&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># In this case is market data</span>
                        <span class="n">_childs</span><span class="p">,</span> <span class="n">childs</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="p">[])</span>
                        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_childs</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Total&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> \
                                        <span class="ow">and</span> <span class="s1">&#39;bold text-right volume&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> \
                                        <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;&lt;td&gt;&lt;/td&gt;&#39;</span><span class="p">:</span>
                                <span class="n">childs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">childs</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="n">rank</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                            <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                                <span class="n">market</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
                            <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                                <span class="n">volume_24h_usd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_int</span><span class="p">(</span>
                                    <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                                <span class="p">)</span>
                            <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                                <span class="n">price_usd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span>
                                    <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                                <span class="p">)</span>
                            <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                                <span class="n">perc_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_float</span><span class="p">(</span>
                                    <span class="n">c</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                                <span class="p">)</span>

                        <span class="n">market_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rank&#39;</span><span class="p">:</span> <span class="n">rank</span><span class="p">,</span>
                                       <span class="s1">&#39;market&#39;</span><span class="p">:</span> <span class="n">market</span><span class="p">,</span>
                                       <span class="s1">&#39;volume_24h_usd&#39;</span><span class="p">:</span> <span class="n">volume_24h_usd</span><span class="p">,</span>
                                       <span class="s1">&#39;price_usd&#39;</span><span class="p">:</span> <span class="n">price_usd</span><span class="p">,</span>
                                       <span class="s1">&#39;perc_change&#39;</span><span class="p">:</span> <span class="n">perc_change</span><span class="p">}</span>
                        <span class="n">exist</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">for</span> <span class="n">_market_data</span> <span class="ow">in</span> <span class="n">exchange_data</span><span class="p">[</span><span class="s1">&#39;markets&#39;</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">market_data</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">_market_data</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]:</span>
                                <span class="n">exist</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">:</span>
                            <span class="n">exchange_data</span><span class="p">[</span><span class="s1">&#39;markets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">market_data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">response</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exchange_data</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">limit</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="c1"># In this case is the exchange name</span>
                <span class="n">exchange_data</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">rank</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\D&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">getText</span><span class="p">()))</span>
                <span class="n">exchange_data</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rank</span>
                <span class="c1"># We create a dict where we will save the markets data</span>
                <span class="n">exchange_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exchange</span>
                <span class="n">exchange_data</span><span class="p">[</span><span class="s1">&#39;markets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">response</span></div></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, lvaro.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'3.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>